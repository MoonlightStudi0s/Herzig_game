<!DOCTYPE html>
<html>
<head>
    <title>Админ панель - Пользователи</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        table { border-collapse: collapse; width: 100%; margin: 20px 0; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        .nav { margin: 20px 0; }
        .nav a { margin-right: 15px; text-decoration: none; color: #007bff; }
        .btn { padding: 5px 10px; text-decoration: none; border-radius: 3px; font-size: 12px; }
        .btn-success { background: #28a745; color: white; }
        .btn-warning { background: #ffc107; color: black; }
        .btn-danger { background: #dc3545; color: white; }
        .admin-badge { background: #28a745; color: white; padding: 2px 6px; border-radius: 3px; font-size: 12px; }
        .current-user { background-color: #f8f9fa; }
    </style>
</head>
<body>
    <h1>Управление пользователями</h1>
    
    <div class="nav">
        <a href="/admin/">Дашборд</a>
        <a href="/admin/users">Пользователи</a>
        <a href="/admin/games">Игры</a>
        <a href="/lobby">В лобби</a>
        <a href="/logout">Выйти</a>
    </div>
    
    <table>
        <tr>
            <th>ID</th>
            <th>Username</th>
            <th>Email</th>
            <th>Статус</th>
            <th>Created At</th>
            <th>Действия</th>
        </tr>
        {% for user in users %}
        <tr {% if user['id'] == current_user.id %}class="current-user"{% endif %}>
            <td>{{ user['id'] }}</td>
            <td>
                {{ user['username'] }}
                {% if user['id'] == current_user.id %}(Вы){% endif %}
            </td>
            <td>{{ user['email'] }}</td>
            <td>
                {% if user['is_admin'] %}
                    <span class="admin-badge">Админ</span>
                {% else %}
                    Пользователь
                {% endif %}
            </td>
            <td>{{ user['created_at'] }}</td>
            <td>
                {% if user['id'] != current_user.id %}
                    {% if user['is_admin'] %}
                        <a href="/admin/users/remove_admin/{{ user['id'] }}" class="btn btn-warning" 
                           onclick="return confirm('Снять права админа с {{ user.username }}?')">Снять админку</a>
                    {% else %}
                        <a href="/admin/users/make_admin/{{ user['id'] }}" class="btn btn-success" 
                           onclick="return confirm('Назначить {{ user.username }} админом?')">Сделать админом</a>
                    {% endif %}
                    <a href="/admin/users/delete/{{ user['id'] }}" class="btn btn-danger" 
                       onclick="return confirm('Удалить пользователя {{ user.username }}?')">Удалить</a>
                {% else %}
                    <em>Текущий пользователь</em>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </table>
</body>
</html>